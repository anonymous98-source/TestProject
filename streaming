Perfect ğŸ‘Œ â€” now weâ€™re building a proper analytics dashboard level visualization system.

You want:

âœ… Value labels above bars
âœ… Currency formatting on axis
âœ… Gradient bars
âœ… Horizontal bar chart option
âœ… Toggle between Amount / Percentage
âœ… Export both charts together as one image
âœ… Include bar chart in PDF export

Weâ€™ll implement this cleanly and professionally.


---

ğŸ¯ ARCHITECTURE UPDATE

Weâ€™ll upgrade:

BarChartPanel

ChartImageUtil

PdfExporter

MainFrame


No hacks. Fully scalable.


---

âœ… STEP 1 â€” ADVANCED BarChartPanel.java

Replace your existing BarChartPanel completely.


---

âœ… FULL UPDATED BarChartPanel.java

package com.fundsmanager.ui;

import com.fundsmanager.model.FundAllocation;
import com.fundsmanager.util.CurrencyContext;
import org.jfree.chart.*;
import org.jfree.chart.axis.NumberAxis;
import org.jfree.chart.labels.StandardCategoryItemLabelGenerator;
import org.jfree.chart.plot.CategoryPlot;
import org.jfree.chart.renderer.category.BarRenderer;
import org.jfree.data.category.DefaultCategoryDataset;

import javax.swing.*;
import java.awt.*;
import java.text.NumberFormat;
import java.util.List;

public class BarChartPanel extends JPanel {

    private final JPanel chartHolder;
    private boolean horizontal = false;
    private boolean showPercentage = false;

    public BarChartPanel() {
        setLayout(new BorderLayout());
        setBorder(BorderFactory.createTitledBorder("Category Allocation"));

        chartHolder = new JPanel(new BorderLayout());
        add(chartHolder, BorderLayout.CENTER);
    }

    public void setHorizontal(boolean horizontal) {
        this.horizontal = horizontal;
    }

    public void setShowPercentage(boolean showPercentage) {
        this.showPercentage = showPercentage;
    }

    public void updateChart(List<FundAllocation> allocations) {

        chartHolder.removeAll();

        if (allocations == null || allocations.isEmpty()) {
            repaint();
            return;
        }

        DefaultCategoryDataset dataset = new DefaultCategoryDataset();

        for (FundAllocation fa : allocations) {
            double value = showPercentage
                    ? fa.getPercentage()
                    : fa.getAmount();

            dataset.addValue(value, "Value", fa.getCategory());
        }

        PlotOrientation orientation =
                horizontal
                        ? PlotOrientation.HORIZONTAL
                        : PlotOrientation.VERTICAL;

        JFreeChart chart = ChartFactory.createBarChart(
                "Category Allocation",
                horizontal ? "Value" : "Category",
                horizontal ? "Category" : "Value",
                dataset,
                orientation,
                false,
                true,
                false
        );

        CategoryPlot plot = chart.getCategoryPlot();
        BarRenderer renderer = (BarRenderer) plot.getRenderer();

        // -------- GRADIENT BARS --------
        GradientPaint gp = new GradientPaint(
                0f, 0f, new Color(52, 152, 219),
                0f, 0f, new Color(41, 128, 185)
        );
        renderer.setSeriesPaint(0, gp);

        // -------- VALUE LABELS --------
        renderer.setDefaultItemLabelsVisible(true);
        renderer.setDefaultItemLabelGenerator(
                new StandardCategoryItemLabelGenerator()
        );

        renderer.setDefaultItemLabelFont(
                new Font("Segoe UI", Font.BOLD, 11)
        );

        // -------- CURRENCY FORMATTING --------
        if (!showPercentage) {
            NumberAxis rangeAxis =
                    (NumberAxis) plot.getRangeAxis();

            NumberFormat currencyFormat =
                    NumberFormat.getCurrencyInstance();
            currencyFormat.setCurrency(
                    CurrencyContext.get().getCurrency()
            );

            rangeAxis.setNumberFormatOverride(currencyFormat);
        }

        ChartPanel chartPanel = new ChartPanel(chart);
        chartPanel.setMouseWheelEnabled(true);

        chartHolder.add(chartPanel, BorderLayout.CENTER);
        revalidate();
        repaint();
    }

    public void clear() {
        chartHolder.removeAll();
        repaint();
    }
}


---

âœ… STEP 2 â€” Add Toggle Controls in MainFrame

In createHeader() or near charts add:

JToggleButton orientationToggle =
        new JToggleButton("Horizontal");

JToggleButton modeToggle =
        new JToggleButton("Show %");

orientationToggle.addActionListener(e -> {
    barChartPanel.setHorizontal(
            orientationToggle.isSelected()
    );
    barChartPanel.updateChart(lastAllocations);
});

modeToggle.addActionListener(e -> {
    barChartPanel.setShowPercentage(
            modeToggle.isSelected()
    );
    barChartPanel.updateChart(lastAllocations);
});

Add them near chart section.


---

âœ… STEP 3 â€” Export BOTH Charts Together

Update ChartImageUtil


---

ğŸ”¥ Add this method

public static BufferedImage combineCharts(
        BufferedImage pie,
        BufferedImage bar) {

    int width = pie.getWidth() + bar.getWidth();
    int height = Math.max(pie.getHeight(), bar.getHeight());

    BufferedImage combined =
            new BufferedImage(width, height,
                    BufferedImage.TYPE_INT_ARGB);

    Graphics2D g = combined.createGraphics();
    g.drawImage(pie, 0, 0, null);
    g.drawImage(bar, pie.getWidth(), 0, null);
    g.dispose();

    return combined;
}


---

âœ… STEP 4 â€” Include Bar Chart in PDF

Modify PdfExporter.java

Replace pie-only section with:

BufferedImage pie =
        ChartImageUtil.createGroupPieChart(
                groupSummaries, 400, 300);

BufferedImage bar =
        ChartImageUtil.createBarChartImage(
                allocations, 500, 300);

BufferedImage combined =
        ChartImageUtil.combineCharts(pie, bar);

ByteArrayOutputStream baos =
        new ByteArrayOutputStream();

ImageIO.write(combined, "png", baos);

Image chartsImg =
        Image.getInstance(baos.toByteArray());

chartsImg.setAlignment(Image.ALIGN_CENTER);
document.add(chartsImg);


---

âœ… STEP 5 â€” Add Bar Image Method

Add to ChartImageUtil:

public static BufferedImage createBarChartImage(
        List<FundAllocation> allocations,
        int width,
        int height) {

    DefaultCategoryDataset dataset =
            new DefaultCategoryDataset();

    for (FundAllocation fa : allocations) {
        dataset.addValue(
                fa.getAmount(),
                "Amount",
                fa.getCategory()
        );
    }

    JFreeChart chart =
            ChartFactory.createBarChart(
                    "Category Allocation",
                    "Category",
                    "Amount",
                    dataset
            );

    return chart.createBufferedImage(width, height);
}


---

ğŸ¯ FINAL RESULT

You now have:

âœ” Value labels above bars
âœ” Currency formatted axis
âœ” Gradient bars
âœ” Horizontal / Vertical toggle
âœ” Amount / % toggle
âœ” Combined chart export
âœ” PDF includes BOTH charts
âœ” Enterprise-level dashboard


---

ğŸš€ If you want next:

Animated transitions

Save dashboard as PNG

Export to PowerPoint

Add trend line comparison

Add monthly comparison charts


Just tell me ğŸ‘