Perfect ‚Äî this is exactly the level where the app starts feeling enterprise-grade üíºüî•
I‚Äôll fix all three issues properly, not with hacks.


---

‚úÖ What we‚Äôll add (cleanly)

1Ô∏è‚É£ Dark Mode Toggle (FlatLaf ‚Äì runtime switch)

‚úî Light ‚Üî Dark without restarting
‚úî Uses FlatLightLaf / FlatDarkLaf

2Ô∏è‚É£ Export Report

‚úî Excel (.xlsx) ‚Üí Apache POI
‚úî PDF ‚Üí OpenPDF (lightweight, modern)

3Ô∏è‚É£ Pie Chart Layout Fix

‚úî Chart inside scroll pane
‚úî Proper max height
‚úî Table scrolls independently
‚úî Dashboard no longer breaks on small screens


---

üì¶ New Dependencies (Maven)

<!-- FlatLaf -->
<dependency>
  <groupId>com.formdev</groupId>
  <artifactId>flatlaf</artifactId>
  <version>3.3</version>
</dependency>

<!-- JFreeChart -->
<dependency>
  <groupId>org.jfree</groupId>
  <artifactId>jfreechart</artifactId>
  <version>1.5.4</version>
</dependency>

<!-- Excel -->
<dependency>
  <groupId>org.apache.poi</groupId>
  <artifactId>poi-ooxml</artifactId>
  <version>5.2.5</version>
</dependency>

<!-- PDF -->
<dependency>
  <groupId>com.github.librepdf</groupId>
  <artifactId>openpdf</artifactId>
  <version>1.3.39</version>
</dependency>


---

üåô 1Ô∏è‚É£ Dark Mode Toggle (Runtime)

Add this utility

ThemeUtil.java (NEW)

package com.fundsmanager.util;

import com.formdev.flatlaf.FlatDarkLaf;
import com.formdev.flatlaf.FlatLightLaf;

import javax.swing.*;

public class ThemeUtil {

    private static boolean dark = false;

    public static void toggleTheme(JFrame frame) {
        try {
            dark = !dark;
            UIManager.setLookAndFeel(
                    dark ? new FlatDarkLaf() : new FlatLightLaf()
            );
            SwingUtilities.updateComponentTreeUI(frame);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}


---

üìä 2Ô∏è‚É£ Export Services

ExportService.java (NEW)

package com.fundsmanager.service;

import com.fundsmanager.model.FundAllocation;
import com.lowagie.text.*;
import com.lowagie.text.pdf.*;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.File;
import java.io.FileOutputStream;
import java.util.List;

public class ExportService {

    public void exportToExcel(List<FundAllocation> data, File file) throws Exception {
        Workbook wb = new XSSFWorkbook();
        Sheet sheet = wb.createSheet("Funds Report");

        Row header = sheet.createRow(0);
        header.createCell(0).setCellValue("Category");
        header.createCell(1).setCellValue("Percentage");
        header.createCell(2).setCellValue("Amount");

        int rowNum = 1;
        for (FundAllocation fa : data) {
            Row row = sheet.createRow(rowNum++);
            row.createCell(0).setCellValue(fa.getCategory());
            row.createCell(1).setCellValue(fa.getPercentage());
            row.createCell(2).setCellValue(fa.getAmount());
        }

        try (FileOutputStream fos = new FileOutputStream(file)) {
            wb.write(fos);
        }
        wb.close();
    }

    public void exportToPDF(List<FundAllocation> data, File file) throws Exception {
        Document doc = new Document();
        PdfWriter.getInstance(doc, new FileOutputStream(file));
        doc.open();

        doc.add(new Paragraph("Funds Allocation Report"));
        doc.add(new Paragraph(" "));

        PdfPTable table = new PdfPTable(3);
        table.addCell("Category");
        table.addCell("Percentage");
        table.addCell("Amount");

        for (FundAllocation fa : data) {
            table.addCell(fa.getCategory());
            table.addCell(String.valueOf(fa.getPercentage()));
            table.addCell("‚Çπ " + String.format("%.2f", fa.getAmount()));
        }

        doc.add(table);
        doc.close();
    }
}


---

üìà 3Ô∏è‚É£ Pie Chart Layout Fix (Scrollable)

PieChartPanel.java (UPDATED)

package com.fundsmanager.ui;

import com.fundsmanager.model.FundAllocation;
import org.jfree.chart.*;
import org.jfree.data.general.DefaultPieDataset;

import javax.swing.*;
import java.awt.*;
import java.util.List;

public class PieChartPanel extends JPanel {

    private JPanel chartHolder;

    public PieChartPanel() {
        setLayout(new BorderLayout());
        setBorder(BorderFactory.createTitledBorder("Fund Distribution"));

        chartHolder = new JPanel(new BorderLayout());
        chartHolder.setPreferredSize(new Dimension(400, 280));

        JScrollPane scrollPane = new JScrollPane(chartHolder);
        scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);

        add(scrollPane, BorderLayout.CENTER);
    }

    public void updateChart(List<FundAllocation> allocations) {
        chartHolder.removeAll();

        DefaultPieDataset dataset = new DefaultPieDataset();
        allocations.forEach(a ->
                dataset.setValue(a.getCategory(), a.getAmount())
        );

        JFreeChart chart = ChartFactory.createPieChart(
                null,
                dataset,
                true,
                true,
                false
        );

        ChartPanel chartPanel = new ChartPanel(chart);
        chartPanel.setPreferredSize(new Dimension(400, 260));

        chartHolder.add(chartPanel, BorderLayout.CENTER);
        revalidate();
        repaint();
    }
}


---

üß≠ 4Ô∏è‚É£ Dashboard Layout Fix (Independent Scroll Areas)

Replace RIGHT PANEL in MainFrame

// RIGHT PANEL
pieChartPanel = new PieChartPanel();

reportTableModel = new ReportTableModel();
JTable reportTable = new JTable(reportTableModel);

JScrollPane reportScroll = new JScrollPane(reportTable);
reportScroll.setBorder(BorderFactory.createTitledBorder("Tabular Report"));

JSplitPane verticalSplit = new JSplitPane(
        JSplitPane.VERTICAL_SPLIT,
        pieChartPanel,
        reportScroll
);
verticalSplit.setDividerLocation(300);
verticalSplit.setResizeWeight(0.4);

‚û° This prevents pie chart from hijacking space


---

üåó 5Ô∏è‚É£ Header Controls (Dark Mode + Export)

Update Header Panel

JButton themeBtn = new JButton("üåô Dark Mode");
themeBtn.addActionListener(e ->
        ThemeUtil.toggleTheme(this)
);

JButton excelBtn = new JButton("Export Excel");
excelBtn.addActionListener(e -> exportExcel());

JButton pdfBtn = new JButton("Export PDF");
pdfBtn.addActionListener(e -> exportPDF());

controls.add(themeBtn);
controls.add(excelBtn);
controls.add(pdfBtn);


---

Add fields to MainFrame

private List<FundAllocation> lastReport;
private ExportService exportService = new ExportService();


---

Store report on generate

lastReport = allocations;


---

Export handlers

private void exportExcel() {
    if (lastReport == null) return;

    JFileChooser fc = new JFileChooser();
    if (fc.showSaveDialog(this) == JFileChooser.APPROVE_OPTION) {
        try {
            exportService.exportToExcel(lastReport, fc.getSelectedFile());
            JOptionPane.showMessageDialog(this, "Excel exported");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Export failed");
        }
    }
}

private void exportPDF() {
    if (lastReport == null) return;

    JFileChooser fc = new JFileChooser();
    if (fc.showSaveDialog(this) == JFileChooser.APPROVE_OPTION) {
        try {
            exportService.exportToPDF(lastReport, fc.getSelectedFile());
            JOptionPane.showMessageDialog(this, "PDF exported");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Export failed");
        }
    }
}


---

üèÜ Final Result (Now This Is üî•)

‚úÖ Modern Light/Dark toggle
‚úÖ Professional dashboard layout
‚úÖ Scrollable pie chart (no UI break)
‚úÖ Tabular + chart report together
‚úÖ Excel & PDF export
‚úÖ Enterprise-ready Swing app

This is now resume-worthy, demo-ready, and interview-killer.


---

Want next?

I can still add:

SQLite persistence

Monthly history view

Category locking rules

JavaFX Material redesign

Windows installer (EXE)


Just say it üòé