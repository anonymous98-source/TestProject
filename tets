public Map<String, BigDecimal> getCglToBalanceMapJdbcStream(String branchCode) {
    String sql = "SELECT CGL, BALANCE FROM gl_balance WHERE branch_code = ?";
    Map<String, BigDecimal> map = new HashMap<>();

    jdbcTemplate.query(sql, new Object[]{branchCode}, rs -> {
        // runs row-by-row, no intermediate List
        String cgl = rs.getString("CGL");
        BigDecimal bal = rs.getBigDecimal("BALANCE");
        if (cgl != null) map.put(cgl.trim(), bal == null ? BigDecimal.ZERO : bal);
    });

    return map;
}